<!DOCTYPE html>
<html>
<head>
  <title>Deploy from Web Integration Test -- RChain</title>
  <style>
    .privateKeyQR { display: hidden }  /* issue: fail safe if no CSS? */
  </style>
</head>
<body>
  <h2>Device REV Account</h2>
  <form id="deployKey3">
    <p id="noDeviceKeyNotice">
      <strong>Welcome!</strong> To participate in rv2020, this app
      maintains an account <strong>on this device</strong> to hold
      a small amount of REV for contract execution.
    </p>
    <fieldset>
      <div id="devKeyViz"></div>
      <label>Device REV address: <input id="devAddr" readonly="readonly" /></label>
      <br />
      <label>
        Device REV balance:
        <input id="devBal" readonly="readonly" placeholder='?'/>
        <button id="checkBalance" type="button">re-check</button>
      </label>
      <br />
      <button type="button" id="devKeyGen">Create Device REV Account</button>
      <p>
        <small><strong>Note:</strong> the private key is stored in
          <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage"
             >localStorage</a> for this web site. To see it, enter
          <code>localStorage.get('deviceKey')</code> in a javascript console.
        </small>
      </p>
      <img id="qr3" class="privateKeyQR" />
    </fieldset>
  </form>
  <script type="module">
    import { acctUI } from './_dist_/intro.js';
    acctUI({
      setTimeout, fetch,
      getElementById: (id) => document.getElementById(id),
      getRandomValues: (arr) => window.crypto.getRandomValues(arr),
      inputElement: (id) => document.getElementById(id),
      localStorage: window.localStorage,
    });
  </script>
  <h2>Introductions: accounts, icons, names</h2>
  <form id="intro1">
    <fieldset>
      <label>Nickname <input id="nickname" /></label>
      <br />
      <img id="blockie1" />
    </fieldset>
  </form>
  <script type="module">
    import { ui } from './_dist_/intro.js';
    ui({
      getElementById: (id) => document.getElementById(id),
      inputElement: (id) => document.getElementById(id),
    });
  </script>
    <hr />
    <h1>Deploy Integration Test</h1>
    <form id="deploy1">
        <fieldset>
            <label>
                Account
                <!--
Private key	5ae90fb24e3d49949ca4d0132b0abfc1eb3213d4285683c5524ec68347dbdfd3
Public key	04e128e43cea6290e500bf2f2e90f1bcc8448a3ce958eca85939ca9896fa5a1bd3fd7923f47a7fb767867790bfc8000e0a35392de42982cdee4e0abfdf3344356b
ETH	186743b4d70f7e8f78b22e11d7d93635d367fd3c
REV	1111B9VWWEpX2b1wWpesgwxt5n9EAsqmTdH2GjaUJrmTWKQw57rPk
                -->
                <select id="account">
                    <option value="5ae90fb24e3d49949ca4d0132b0abfc1eb3213d4285683c5524ec68347dbdfd3">1111B9VWWEpX2b1wWpesgwxt5n9EAsqmTdH2GjaUJrmTWKQw57rPk</option>
                </select>
            </label>
            <br />
            <label>Timestamp: <input type="integer" name="timestamp" /></label>
            <br />
            <textarea id="term" cols="80" rows="12">
new deployId!(`rho:rchain:deployId`),
log(`rho:io:stderr`)
in {
  log!("hello") |
  deployId!(1 + 1)
}
            </textarea>
            <br />
            <label>
              Validator
              <select id="apiBase">
                <option value="https://node1.testnet.rchain-dev.tk:443">testnet node 1</option>
              </select>
            </label>
            <br />
            <label>
              Observer
              <select id="observerApiBase">
                <option value="https://observer.testnet.rchain.coop">testnet observer</option>
              </select>
            </label>
            <br />
            <button id="deploy" type="button">Deploy</button>
        </fieldset>
    </form>
    <hr />
    <address>
        <a href="https://www.madmode.com/">Dan Connolly</a>
    </address>
    <noscript>Please excuse lack of non-JavaScript support.</noscript>
    <script type="module">
        import ui from "./_dist_/rgate.js";
        ui({
            fetch,
            getElementById: (id) => document.getElementById(id),
            inputElement: (id) => document.getElementById(id),
            clock: () => new Date()
        })
    </script>
</body>
</html>
